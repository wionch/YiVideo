# YiVideo 产品需求文档 (PRD)

## 1. 项目愿景

YiVideo 旨在成为一个一站式、模块化的 AI 视频处理与本地化平台。我们致力于通过自动化和人工智能技术，赋能全球的内容创作者和营销团队，帮助他们轻松地将视频内容进行多语言翻译、配音和分发，打破语言障碍，提升内容影响力。

## 2. 目标用户

*   **内容创作者 (YouTubers, TikTokers)**: 希望将自己的视频快速翻译成多种语言，以触及更广泛的国际观众。
*   **营销与媒体团队**: 需要将产品宣传、品牌故事等视频内容进行本地化，以适应不同国家和地区的市场。
*   **教育机构与在线课程提供商**: 希望为自己的教学视频提供多语言字幕和配音，提升课程的可访问性。

## 3. 功能范围 (Scope)

项目将分阶段进行，MVP (最小可行产品) 阶段将聚焦于最核心的“视频翻译与本地化”功能。

### P1: 视频翻译与本地化 (MVP 核心)

#### 3.1. 视频获取
- **需求**: 系统需支持从主流视频平台（如 YouTube）下载指定的视频源文件。
- **用户故事**: 作为用户，我希望能输入一个视频链接，系统就能自动为我下载好视频以进行后续处理。

#### 3.2. 字幕提取
- **需求**: 系统必须提供两种独立的字幕提取模式，并支持对 OCR 模式进行手动干预。
  - **模式A (OCR)**: 自动识别并提取视频画面内嵌的硬字幕。
    - **手动区域选择 (可选)**: 对于自动识别效果不佳的视频，系统应提供一个界面，允许用户通过截取视频中的一帧画面，并手动拖拽鼠标框选出精确的字幕区域。
  - **模式B (ASR)**: 通过语音识别技术，将视频中的对话转录成字幕文本。
- **用户故事**: 
  - 作为用户，当我的视频有硬字幕时，我希望能选择 OCR 模式；当我的视频是无字幕的访谈时，我希望能选择 ASR 模式。
  - 作为高级用户，当自动识别的字幕区域不准确时，我希望能手动框选字幕位置，以提高后续 OCR 的准确率。

#### 3.3. 字幕翻译
- **需求**: 系统需能将提取出的原始字幕，通过大语言模型 (LLM) API (如 Gemini, DeepSeek) 翻译成用户指定的一种或多种目标语言。
- **用户故事**: 作为用户，我希望能将我的中文字幕翻译成英文、日文和韩文，以吸引这些地区的用户。

#### 3.4. 字幕校对与优化
- **需求**: 系统利用大语言模型（LLM）对提取和翻译后的字幕进行自动校对与优化。这包括但不限于：错别字修正、语法错误纠正、标点符号标准化、以及根据目标语言习惯调整断句和长度。人工校正功能将作为最终的质量保障环节，允许用户在AI处理后进行最后的审查和微调。
- **用户故事**: 作为用户，我期望系统能智能地处理大部分字幕的瑕疵，减少我的手动编辑工作。对于AI翻译后可能过长的句子，系统应该能自动将其拆分为适合阅读的多行。只有在极少数情况下，我才需要手动介入进行修改。

#### 3.5. 成本与用量统计
- **需求**: 系统需要提供一个面板或功能，用于追踪和统计翻译服务产生的 Token 消耗和预估费用。
- **用户故事**: 作为用户，我希望能清晰地看到每次翻译任务花费了多少钱，以便我管理预算。

#### 3.6. 硬字幕去除 (Post-MVP)
- **需求**: 对于包含硬字幕的视频，系统应能根据 OCR 识别的字幕位置，智能去除或模糊掉原始字幕。

#### 3.7. AI 配音 (Post-MVP)
- **需求**: 系统能使用高质量的 TTS (Text-to-Speech) 技术（如 IndexTTS），根据翻译好的字幕文件，生成自然流畅的目标语言配音。

#### 3.8. 视频合成 (Post-MVP)
- **需求**: 系统能将处理好的视频（原视频或去除字幕后的视频）、新的翻译字幕、新的 AI 配音合并，生成最终的本地化视频。

### P2: 全自动视频生成 (远期规划)
- **概要**: 参考 `MoneyPrinterTurbo` 模式，用户只需提供主题或关键词，系统即可自动生成文案、匹配素材、合成完整的短视频。

### P3: 自动发布 (远期规划)
- **概要**: 集成各大自媒体平台（YouTube, Bilibili, TikTok 等）的官方 API 或通过浏览器自动化技术，实现处理完成的视频一键发布到多个平台。

## 4. 用户界面核心需求 (Frontend)

### 4.1. 任务管理系统
- **任务创建**: 提供一个清晰的界面，让用户可以发起一个新任务。必填项包括：视频源链接、处理模式 (OCR/ASR)、目标语言等。
- **任务列表与状态**: 
    - 用户可以看到所有历史任务及其当前状态，例如：排队中、下载中 (10%)、处理中、已完成、失败。
    - **(增强)** 对于“失败”的任务，系统应明确展示失败在哪一个步骤（如：视频下载失败），并提供可操作的“重试”按钮。
- **结果查看与下载**: 用户可以方便地查看已完成任务的详情，并下载生成的字幕文件、音频或最终视频。
- **(新增)** **用户旅程与错误处理**:
    - 如果视频下载失败，任务状态变为“失败”，用户可点击“重试”或“编辑”来修改链接后重试。
    - 如果字幕提取或翻译失败，用户同样可以针对该步骤进行“重试”。

## 5. 非功能性需求 (增强)

- **异步与性能**: 所有耗时超过5秒的操作都必须在后台异步执行。对于核心的字幕提取任务，在系统资源（特别是GPU）可用的情况下，95% 的任务应在提交后 10 秒内开始处理。在单GPU部署场景下，由于存在GPU资源锁，任务将按顺序排队执行，实际开始时间取决于前方任务的处理时长。
- **可扩展性**: 系统架构必须是模块化的，便于未来新增功能模块（如新的 TTS 引擎、新的发布平台），服务之间通过 API 通信，低耦合。
- **易用性**: 界面应简洁直观，确保新用户在无引导情况下，3 分钟内可以成功发起一个完整的视频翻译任务。
- **安全性**: 用户敏感信息（如 API Key）在传输和存储时必须加密。系统需能防御常见的 Web 攻击（如 XSS, CSRF）。

## 6. 用户账户与安全 (P1.5 规划)

- **用户认证**:
    - **需求**: 系统需支持用户通过邮箱/密码或第三方登录（如 Google, GitHub）进行注册和登录。
    - **用户故事**: 作为用户，我希望能创建一个属于我自己的账户，以保存我的任务历史和设置。
- **API Key 管理**:
    - **需求**: 系统应提供一个安全的界面，让用户可以添加、编辑和删除自己的第三方服务 API Key（如 Gemini API Key）。这些密钥应与用户账户绑定，并进行加密存储。
    - **用户故事**: 作为用户，我希望能使用自己的 API Key，并方便地在需要时进行更换，而不是使用系统全局的 Key。
- **数据隔离**:
    - **需求**: 每个用户只能查看和管理自己的任务数据和素材。
