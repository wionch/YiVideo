# 任务清单：工作流节点文档功能一致性检查

## 变化 ID

check-workflow-nodes-documentation-consistency

## 任务执行顺序

### 阶段 1: 代码分析和初步检查

#### [ ] 任务 1.1: 分析目标文档结构

**描述**: 深入分析 `WORKFLOW_NODES_REFERENCE.md` 文档的结构和内容组织方式
**输出**:

-   文档结构分析报告
-   识别文档中的节点列表
-   记录每个节点的关键信息（参数、输出、依赖等）
    **状态**: 待执行

#### [ ] 任务 1.2: 扫描所有工作流节点实现代码

**描述**: 全面扫描各个服务目录中的任务实现代码
**输出**:

-   节点实现代码清单
-   每个节点的主要函数和方法列表
    **状态**: 待执行

#### [ ] 任务 1.3: 收集节点参数定义

**描述**: 从代码中提取每个节点的参数定义和解析逻辑
**输出**:

-   节点参数定义对比表
-   参数类型和默认值清单
    **状态**: 待执行

### 阶段 2: 详细一致性验证

#### [ ] 任务 2.1: FFmpeg 服务节点一致性检查

**描述**: 检查 FFmpeg 服务的 4 个节点（extract_keyframes, extract_audio, crop_subtitle_images, split_audio_segments）
**检查项目**:

-   参数定义一致性
-   输出格式匹配度
-   智能源选择逻辑
-   单任务模式支持
    **输出**:
-   FFmpeg 节点一致性报告
-   发现问题清单
-   修复建议
    **状态**: 待执行

#### [ ] 任务 2.2: Faster-Whisper 服务节点一致性检查

**描述**: 检查 Faster-Whisper 服务的 transcribe_audio 节点
**检查项目**:

-   音频路径参数处理
-   全局配置参数使用
-   输出格式准确性
    **输出**:
-   Faster-Whisper 节点一致性报告
    **状态**: 待执行

#### [ ] 任务 2.3: Audio Separator 服务节点一致性检查

**描述**: 检查 Audio Separator 服务的 separate_vocals 节点
**检查项目**:

-   模型选择参数
-   质量模式配置
-   输出音频格式
    **输出**:
-   Audio Separator 节点一致性报告
    **状态**: 待执行

#### [ ] 任务 2.4: Pyannote Audio 服务节点一致性检查

**描述**: 检查 Pyannote Audio 服务的 3 个节点（diarize_speakers, get_speaker_segments, validate_diarization）
**检查项目**:

-   Hugging Face Token 配置
-   说话人分离参数
-   输出数据格式
    **输出**:
-   Pyannote Audio 节点一致性报告
    **状态**: 待执行

#### [ ] 任务 2.5: PaddleOCR 服务节点一致性检查

**描述**: 检查 PaddleOCR 服务的 4 个节点
**检查项目**:

-   MinIO URL 处理
-   字幕区域检测逻辑
-   OCR 参数字段
-   输出结果格式
    **输出**:
-   PaddleOCR 节点一致性报告
    **状态**: 待执行

#### [ ] 任务 2.6: IndexTTS 服务节点一致性检查

**描述**: 检查 IndexTTS 服务的 3 个节点（generate_speech, list_voice_presets, get_model_info）
**检查项目**:

-   TTS 合成参数
-   语音预设信息
-   模型信息输出
    **输出**:
-   IndexTTS 节点一致性报告
    **状态**: 待执行

#### [ ] 任务 2.7: WService 服务节点一致性检查

**描述**: 检查 WService 服务的 6 个节点
**检查项目**:

-   字幕生成参数
-   AI 优化配置
-   说话人合并逻辑
-   TTS 片段准备
    **输出**:
-   WService 节点一致性报告
    **状态**: 待执行

### 阶段 3: 跨节点依赖关系验证

#### [ ] 任务 3.1: 验证工作流依赖关系矩阵

**描述**: 检查文档中的依赖关系矩阵与实际代码实现是否一致
**输出**:

-   依赖关系验证报告
-   发现的循环依赖（如果有）
    **状态**: 待执行

#### [ ] 任务 3.2: 验证数据流向说明

**描述**: 检查文档中描述的数据流向（语音转录流程、OCR 流程、语音合成流程）
**输出**:

-   数据流向验证报告
    **状态**: 待执行

### 阶段 4: 文档修复和更新

#### [ ] 任务 4.1: 修复参数定义不一致

**描述**: 根据检查结果修复文档中的参数定义错误
**操作**:

-   更新参数类型和默认值
-   修正参数来源说明
-   补充缺失的参数描述
    **状态**: 待执行

#### [ ] 任务 4.2: 更新输出格式描述

**描述**: 同步更新文档中的输出格式描述
**操作**:

-   补充新的输出字段
-   修正输出字段描述
-   删除过时的字段说明
    **状态**: 待执行

#### [ ] 任务 4.3: 修正功能描述

**描述**: 修正与实际代码实现不符的功能描述
**操作**:

-   更新智能源选择逻辑说明
-   修正单任务模式支持描述
-   补充缺失的功能特性
    **状态**: 待执行

#### [ ] 任务 4.4: 更新使用示例

**描述**: 更新或重新测试文档中的使用示例
**操作**:

-   验证现有示例的有效性
-   创建缺失的示例
-   修正格式错误的示例
    **状态**: 待执行

### 阶段 5: 验证和质量保证

#### [ ] 任务 5.1: 生成一致性检查报告

**描述**: 汇总所有检查结果，生成完整的一致性检查报告
**输出**:

-   详细的一致性检查报告
-   问题统计和严重程度分析
-   修复完成度评估
    **状态**: 待执行

#### [ ] 任务 5.2: 验证修复效果

**描述**: 验证文档更新后的准确性和完整性
**操作**:

-   随机抽样验证
-   交叉引用检查
-   示例代码测试
    **状态**: 待执行

#### [ ] 任务 5.3: 最终文档评审

**描述**: 进行最终的文档质量评审
**输出**:

-   最终评审报告
-   改进建议
    **状态**: 待执行

## 验证方法

1. **参数对比**: 文档 vs 代码实现对比表
2. **输出验证**: 实际执行结果 vs 文档描述对比
3. **功能测试**: 验证文档示例的可执行性
4. **交叉检查**: 多个节点间的依赖关系验证

## 质量标准

1. **完整性**: 所有节点参数和输出都有文档记录
2. **准确性**: 文档描述与代码实现 100% 一致
3. **时效性**: 文档反映最新的代码实现
4. **可用性**: 所有示例代码都可以正常运行

---

**最后更新**: 2025-12-02T05:36:00Z
**状态**: 待执行
